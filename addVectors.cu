#include <cuda_runtime.h>
#include <stdio.h>
#include <iostream>
#include "device_launch_parameters.h"
#include "addVectors.cuh"
cudaError_t addWithCuda(int* c, const int* a, const int* b, unsigned int size);

__global__ void addKernel(int* c, const int* a, const int* b, int numElements)
{
    int i = blockDim.x * blockIdx.x + threadIdx.x;
    if (i < numElements)
    {
        c[i] = a[i] + b[i];
    }
}

#define SIZE 1024

int addConstWrapper() {
    // Allocate the host input vector A
    int h_A[SIZE] = { 1304941746, 1937220883, 264045416, 67741060, 122940899, 1546862639, 114152994, 1512058311, 1145889064, 1295752786, 1718438565, 2055758365, 519114684, 1943783277, 656281595, 435569001, 1124921912, 567890412, 591461109, 1604195710, 1498829387, 367478606, 1980680359, 1227334432, 1249677728, 1588045909, 1536944417, 1018767167, 1209081093, 1455414276, 1318174521, 1679102382, 2116289515, 1684580114, 735140620, 1274668985, 2144866878, 1699468741, 1374200860, 809665717, 1154923096, 1297027587, 1746548605, 452959319, 983377903, 526025092, 1651873225, 449681563, 157152973, 33462421, 1128070206, 978779953, 802795349, 956033379, 1310084572, 505907502, 2015927075, 861907885, 1971246196, 275654436, 1075757152, 961209228, 859323354, 53342174, 1397668821, 1908769921, 1394936001, 1503708816, 1270831273, 79760263, 2077957644, 750956217, 241119207, 1413909456, 780247659, 872022207, 343759772, 288667892, 1096638579, 72075807, 428814661, 725079131, 573428307, 1873998364, 393562847, 130208129, 391942746, 122954267, 346544800, 697943709, 1078943968, 835313622, 1255713703, 478303219, 1465991581, 551692386, 383741107, 1571073257, 1358075818, 653945346, 1103862954, 2075675509, 1665317821, 2128867653, 1588009851, 991171433, 101809982, 1942173912, 802982922, 1562392320, 823372510, 2016297099, 1243372577, 16799383, 589991034, 58119764, 1454898204, 1042176040, 37457753, 837111350, 1702887760, 2144937776, 1507284191, 1014737781, 65137876, 284274321, 396247512, 2095624003, 1592974481, 2093584836, 635684467, 1729335856, 2138016226, 915831400, 1647588294, 1653457937, 1433741886, 860206502, 1443056458, 956325894, 157107088, 249221072, 1393687988, 45491042, 162301165, 874660689, 2143296832, 741084655, 1080541145, 14336094, 1262375157, 1783638199, 1171222449, 1342175824, 223821688, 1974989593, 1391618287, 934283377, 274088444, 1477001449, 971366651, 1234375241, 660691387, 953525597, 1484892303, 174394676, 488172075, 1148417208, 306910280, 2126189783, 494127455, 911660745, 2030422745, 376084722, 678234894, 593417150, 2057264661, 469297732, 1655768639, 164221284, 243201374, 1592961107, 149165188, 243284326, 937004051, 986807437, 28202542, 1169393601, 1596928657, 68169181, 1251080846, 1777281449, 341895075, 1731334259, 1521918863, 843357361, 86687857, 349010039, 882729487, 691928514, 814284826, 1103381397, 1429720486, 753629008, 1670769674, 1006845399, 1483384520, 1935228732, 735738733, 1675459662, 1267151240, 1875294186, 660168195, 1589692142, 669114942, 1215147572, 1812872961, 178403489, 296336673, 1974275295, 1753830686, 593989572, 1470280246, 767527506, 1900814001, 168709280, 666836895, 226837042, 2120824044, 722419124, 1950666193, 2125855108, 2108612019, 563681658, 1088807447, 77087743, 1224110351, 1784886044, 1052811973, 605442280, 700433423, 1826623919, 670671380, 546791761, 1722506497, 1286467115, 1059293935, 994260901, 1421613525, 1277887350, 1948415864, 1058091809, 2026052409, 1571949516, 1100424109, 1737523060, 804059710, 1020644203, 1322640644, 2118742866, 689163203, 275868889, 375081261, 621395796, 680588702, 12148462, 1106774591, 1506563486, 1765734478, 1916724087, 960937503, 372048823, 775943183, 1092244655, 812645344, 848763674, 173746560, 1102782037, 247278705, 198038960, 1475977331, 1409388326, 1280427694, 1420611627, 1699497518, 1617353463, 549131919, 130464939, 1234611666, 1276175282, 138729821, 1401581909, 1102087871, 861304202, 2081058131, 129750336, 1269530585, 1844820088, 160123178, 1301153156, 160316487, 225088423, 612941610, 2034523508, 1578262957, 1747326638, 1140670451, 2029469159, 1358305197, 1444641252, 1802632876, 553947846, 966046603, 1327154445, 1369232355, 838306830, 1251846924, 91513600, 1418948616, 1564858163, 1141768603, 419237056, 18642405, 230230082, 1044512281, 521343635, 1101779274, 1624341323, 1326575769, 1046512011, 1284836073, 2077873318, 800730447, 106504237, 456730, 921923340, 688579906, 1277180741, 1642382964, 2084169915, 1034798509, 1239073107, 1533321384, 2056920013, 1519942903, 1260737981, 693283569, 1046494679, 1213030921, 1566209431, 676877668, 208229338, 1681809520, 2072679887, 845337254, 1716120434, 319912408, 1869229898, 1523640676, 418163650, 587130991, 1553395261, 722545635, 626944929, 1605405208, 1001580561, 386319837, 1500256803, 547736330, 1097354546, 1287335548, 1125725699, 1473701225, 1312998102, 478654565, 1745958186, 1262579736, 198716469, 1604276091, 1773218281, 871332112, 1196996879, 1837125093, 1178297658, 1975223077, 1630451359, 794159888, 574839287, 1456165359, 970235720, 1471515493, 853121833, 1720580057, 424253306, 1877499701, 92086503, 677303133, 1859000114, 1838853417, 604322353, 1017982681, 634184177, 695983474, 1932520036, 949377205, 1939485110, 1323982366, 860020632, 1696961597, 2074451275, 1334261877, 2028325816, 1308137512, 231025940, 482172760, 518616481, 922638357, 1164814363, 214340474, 1623287017, 1705122859, 1437126729, 2060411774, 1778700352, 1433937652, 889383726, 1724722109, 484797244, 362584530, 1884883256, 1551171478, 197429083, 1408816747, 1944948019, 164610550, 639391252, 688556219, 603871339, 78698047, 63890421, 1940756023, 2133351582, 1723500042, 255886811, 1186488363, 783358214, 249302508, 916502382, 195547097, 1133792828, 2134718142, 82407409, 1702218413, 1277275059, 921366793, 1146068513, 146955979, 85150005, 1602601625, 1809056946, 334323235, 1231782535, 1425718811, 94261350, 714768022, 1981423555, 853754610, 1377793230, 602626066, 41922189, 1848750121, 91148379, 172443501, 1718678474, 517335201, 269167819, 1825183286, 1435284180, 1501751623, 577200709, 610116061, 771038514, 327487933, 1872360048, 508932737, 306623210, 954789291, 58421663, 574069975, 754794270, 1009868262, 1943063613, 377428796, 1790986349, 612926029, 1948216418, 631844027, 539429114, 573119381, 1889445960, 31104103, 1292251329, 446357112, 2113126186, 980289481, 2111832264, 1744398899, 530241996, 990792727, 1853524467, 394448108, 679277199, 78544874, 1985624096, 1483011828, 1733716373, 1776171930, 352525678, 81673398, 1095472482, 1038605025, 904636976, 819749680, 609864324, 1608623670, 1266777516, 1970162381, 881880266, 1017277380, 552887862, 300123474, 1866921492, 1017604642, 3857152, 390131738, 13757272, 11667085, 2064257040, 205789573, 494475524, 842542860, 1670001374, 1559824107, 566445200, 1124418707, 782423400, 1258453649, 1353353939, 573824766, 1227852684, 309057077, 245209621, 12520557, 1152140927, 688620730, 2032723373, 1260385844, 48901535, 1959639093, 1102344144, 1734679797, 213632686, 239145141, 974224442, 776714068, 1776926412, 1296203434, 1406495308, 36635399, 1527034121, 2057769040, 108936071, 820031299, 1843397540, 773184341, 1568760896, 535541933, 1206030288, 1201896560, 1587656981, 87364560, 916898127, 1091752131, 544808338, 587062375, 1853643659, 1336632659, 1668019004, 2120417336, 641367054, 14707285, 1106498519, 1845037885, 1324936292, 197816242, 730577779, 1982209371, 1668748798, 1823385693, 2054865385, 2137915948, 760312188, 1576121479, 1336245269, 1644780441, 147689549, 2040256626, 62253296, 1419233229, 489778013, 4815565, 1902230274, 720348050, 766019144, 1489568913, 659214517, 286942630, 659582525, 1700374250, 1264635630, 1825956470, 709675121, 519029600, 1309056663, 11634357, 1407828653, 871706821, 2003474859, 438587056, 1988304968, 1295411237, 1260673534, 1919562542, 1297934329, 1768600206, 522640539, 1827411491, 1018318828, 2004244077, 2137220273, 1978726520, 2032328357, 412656909, 147520918, 362846276, 631916286, 488378075, 1093127732, 1665362232, 1732910114, 658664725, 586068170, 1340382666, 537550012, 1784278842, 1065537882, 1924851915, 170987760, 691218511, 1041269142, 306850916, 564838652, 1418291601, 1055685961, 1901544799, 75165328, 749179432, 751318445, 118136849, 1139221546, 1816155094, 1370453758, 1007658371, 1783548537, 1859950197, 605458022, 203035812, 814546457, 680779411, 410013951, 363861197, 847566439, 1146412779, 1055119080, 740269693, 1019481672, 104132758, 2002464500, 1783893300, 663184363, 168379773, 1515677315, 291455412, 1992742998, 2052972542, 1407075386, 740452582, 1382390720, 1706043061, 1003931341, 336883130, 707770245, 118381147, 1552807017, 53796838, 1251150649, 1337150118, 593592196, 802084440, 453356706, 694124849, 976923425, 1967590269, 1173959144, 501856650, 1824978788, 2053819851, 1279755669, 948016482, 1926991798, 753586772, 1223989932, 1650003116, 1571858773, 108950027, 1012177243, 1738163923, 90168659, 53447519, 936936578, 1294534641, 1394043950, 999697103, 1225588194, 1211395011, 802043257, 2035755145, 1908235025, 1696131670, 1842878522, 1210341981, 460672926, 549189139, 211809152, 1814969389, 1157940827, 1763177448, 15407578, 930817102, 415620840, 98608469, 1959710248, 1096213639, 1525154580, 905588128, 302459711, 1928121572, 769468718, 1313974222, 932463721, 2130023601, 1943480345, 347422031, 213624657, 1052400048, 1272967598, 1846909595, 1137888484, 658172175, 1440501248, 1736108870, 1532206765, 358609948, 1846573858, 1135469705, 506560486, 574474833, 716243412, 113961459, 52652349, 1559113566, 169886377, 263330497, 2054179101, 1823334277, 337779328, 942674013, 781222646, 2024177928, 826384484, 1111866789, 2130173644, 1635502155, 460754838, 1628801477, 768341474, 1839027134, 151487261, 98519064, 876376655, 1405379416, 1186329192, 936658428, 1501853742, 300381048, 1825516694, 1513699550, 951105811, 359656450, 603698023, 1925267836, 881405674, 162783700, 1571685305, 1091075650, 35672457, 1514734296, 549541199, 1042069841, 1117261785, 84665873, 607215078, 456017873, 452599832, 822697890, 656648602, 280853705, 69809752, 423463564, 704940170, 1942073369, 1863510633, 1962614277, 1613233094, 169479479, 52167711, 1378306062, 1852510775, 70220030, 502514610, 1213924814, 1493399998, 549733840, 1938415925, 1057221159, 340252972, 1236485074, 13651250, 321848142, 1908816174, 62411927, 745472973, 472883027, 1127558276, 608127059, 1436020978, 641752450, 1169346745, 197663431, 17200048, 1456151469, 2106695472, 413732977, 1596768600, 1599747419, 1226908741, 1171601364, 955393688, 275398167, 40103802, 1565541203, 558093453, 110578461, 1251296296, 540235573, 1563126484, 1625949364, 394056290, 1495201382, 627779814, 1201442369, 462140852, 1679586622, 1870044477, 1353002856, 691026369, 1238789412, 830870417, 829076372, 1657609766, 1203179410, 1218215340, 448107262, 573843820, 1455612873, 743290150, 908828542, 735131679, 475481894, 248432658, 220357140, 452061514, 41095201, 661030778, 1217614997, 91999871, 1244409499, 954955885, 775003194, 1488341758, 582939692, 592704013, 1289579263, 1932699751, 1785528201, 1446062261, 973107789, 1317548246, 1033572059, 1884374564, 2252273, 377014167, 1139105999, 791694885, 713286110, 1997241612, 216701257, 640510389, 1770297670, 1123858030, 459375254, 1266743917, 173076771, 299202385, 267903892, 1310352238, 2012467738, 1516817937, 871852809, 770715635, 293582171, 733881075, 1062935577, 2016563948, 1800117957, 2094091822, 1415374974, 1544492606, 1650160608, 647616927, 1879788293, 40737018, 1497851922, 601378825, 1718584130, 1807360004, 1992568059, 374966081, 1768148895, 1593769587, 1236984713, 1532792767, 606246206, 2093327785, 626013069, 2026987666, 403946582, 2103090098, 1477795992, 2124019588, 1929079735, 913579128, 30169727, 534700487, 1532591591, 1071618179, 1521364188, 1126968696, 1386729024, 89049912, 1666273897, 223576160, 2036278615, 1824535336, 736167885, 268003786, 1437483573, 144444470, 322644475, 1118488275, 660131384, 329845075, 499550106, 14138671, 382142956, 1751537576, 71742514, 1971153685, 6812698, 1327128441, 1301793002, 1260744555, 629231493, 2059446227, 2084333983, 659628388, 1073073662, 630993643, 298803587, 1311419250, 748320898, 581879749, 743103266, 780600894, 2053755160, 1492896547, 1555377915, 1799857441, 2011346480, 989001730, 594787228, 397694886, 490619933, 1093001010 };

    // Allocate the host input vector B
    int h_B[SIZE] = { 621814188, 754150719, 366154872, 215228382, 863197914, 1800560245, 977105658, 1761835698, 1517624459, 608960134, 1161340847, 198134521, 1860244115, 1546838823, 503107724, 1961223341, 225306237, 1388967328, 635631473, 714402008, 1003574701, 1612982382, 1879536917, 979085775, 375603570, 820632646, 1496320626, 2056059101, 815066797, 1865362689, 1890983278, 295612786, 99509147, 560266976, 1141292177, 86486359, 1642147591, 1978063590, 779319525, 476394941, 250227979, 544383865, 168311106, 808146051, 1908373595, 154068777, 57643826, 1620679092, 2134261677, 892293593, 1308131406, 1125453437, 530765046, 29512561, 1765699096, 317524020, 1802935089, 1614992033, 1314867204, 807140451, 801679528, 580146729, 1410890791, 1016476328, 86804595, 378255379, 740066226, 50247702, 312258547, 433432197, 585667766, 1946401071, 1612864102, 64881755, 1689563892, 1856004811, 1833231435, 1203083127, 342010066, 346823752, 1980845728, 1823750662, 81304300, 1844259580, 1953758628, 324036843, 881164346, 633061953, 1536863723, 1126792459, 1569965916, 1422703740, 1123981515, 204868634, 550379026, 1894806243, 1276771518, 957169414, 1297587974, 1751638665, 784153475, 1495805700, 51146128, 2011862621, 679327714, 519470171, 1826485055, 1357523686, 272993483, 121490856, 2114084707, 1207113617, 1439886708, 453964747, 670744729, 1693853988, 2133795273, 972732377, 1023560046, 1625467605, 1828282783, 1804697743, 1939628040, 162783465, 429646453, 888510386, 153087772, 1639620089, 2112423386, 35481867, 4220953, 2090582671, 624028248, 27990332, 1752942750, 1202992407, 1650912065, 793542429, 1874944283, 1508194334, 1240600216, 553354601, 197361427, 839178821, 2139075879, 797985632, 456512897, 2133829410, 1656916055, 580645792, 1667794031, 548633395, 496361053, 466795259, 151018071, 380928776, 76727017, 637822627, 979774420, 436389609, 204178490, 967179835, 1975459896, 1741232532, 967861692, 599783812, 1958032875, 1659394524, 343109384, 530731968, 1953695728, 1885745742, 1845944122, 157027541, 1853086171, 1649601545, 1827792391, 570472400, 1422823330, 993177294, 338615961, 731373449, 593894667, 456075469, 221990461, 1431131507, 1898468182, 2058625287, 1545478323, 127679903, 661586331, 1160861859, 99095533, 1997663714, 1895555544, 1765120237, 288834820, 235853045, 592294365, 1819733538, 1678735952, 842487368, 125291351, 879165495, 821798189, 774366873, 636643200, 1825279595, 1519079344, 110173949, 371333375, 1353839097, 76820577, 1542897682, 134137009, 1483399769, 171045322, 1095109799, 932032497, 1967106347, 833637046, 1089731559, 381734657, 58535331, 295503520, 1020481593, 2044003467, 1327005090, 1816529184, 642455339, 1937566697, 1616055506, 156774949, 257465044, 390473305, 695154485, 671077316, 546906949, 404929903, 806142326, 774151561, 1367270319, 2053460961, 644011776, 1269210886, 1525689043, 1264838575, 1020422306, 1557942559, 362937324, 1354975093, 1025042567, 695494206, 931380734, 29908149, 1800857532, 1416663331, 1474731090, 1567435965, 897663494, 1257726334, 1748457138, 1270129790, 1796694786, 1899283146, 481520918, 1070240272, 985343353, 931029354, 718674939, 1506763500, 1764997213, 1392693027, 2098583828, 1063503874, 1501808547, 1124632563, 548827821, 1724177833, 927867407, 210187422, 435268274, 768468164, 898678524, 1189852067, 512951374, 1989402287, 1325075102, 1222709595, 2047257010, 2124938956, 312476381, 356880298, 1349366577, 1059343162, 1409551814, 1539138662, 402474631, 1117948068, 1859620697, 771022971, 709448406, 355553362, 1847553276, 1163215143, 1716992778, 1001424899, 95274675, 743289714, 1291879680, 1574391588, 924679813, 251284287, 1126169781, 480823953, 1529548842, 1063395253, 1864788535, 2126037108, 849727925, 1164701154, 134955407, 301222567, 1376947603, 1674871334, 699661510, 1075291482, 2067825877, 804012120, 548324476, 1884818841, 389199350, 21903270, 72195415, 1671362400, 1142225334, 1341160396, 707222312, 1507410823, 539411597, 458029902, 2136577783, 715930783, 712413505, 955948376, 657295329, 1191127651, 1494014016, 1152998916, 1213487652, 340649124, 1365457575, 1485410079, 1176708836, 2009366154, 1880135763, 807709893, 1853233793, 1778666263, 896099932, 1678901632, 1280414561, 452406292, 1935576557, 45670713, 134799228, 1209809899, 2068129357, 1425453042, 1393073584, 665991332, 1607247957, 847471949, 849858254, 1731161752, 1065785556, 1151869799, 1985125372, 825661399, 1062197651, 627315194, 1257651949, 549770035, 237377775, 128168556, 1115074978, 608693410, 120377466, 1887837389, 1934819924, 568710258, 586611582, 1051838302, 1177372500, 49987939, 601348165, 1289083382, 366944578, 889814125, 1666592847, 87290064, 1812142570, 1209023464, 4665185, 755272108, 273409050, 645123295, 897078775, 1284273938, 1426977651, 19054130, 2011565010, 1739842283, 999507282, 835348293, 1500155441, 1152800658, 1618621831, 949850751, 1163717679, 1415288479, 881621577, 149663714, 1609889723, 1705667979, 620715882, 770225895, 885375974, 715823185, 844757290, 256016089, 326326188, 1362243447, 1623157221, 1420751388, 1869733410, 2076517981, 601484345, 235088044, 1512635700, 953274147, 1517994485, 470665178, 2086084572, 2140770067, 590176194, 980787298, 1658119255, 713966753, 360157647, 1773184080, 675790713, 686278749, 1780916461, 1341165480, 714639168, 1131936447, 1870456022, 341036816, 641606341, 444931513, 583625743, 801269, 1621265908, 1228054178, 702002516, 2063830965, 408489376, 507584641, 1523992859, 1187990702, 1995706100, 176298385, 1775045126, 1380251773, 851658437, 1500950354, 1103418449, 1529545531, 69035998, 411140616, 1463870672, 1348096, 930113999, 1914282237, 210199210, 397771590, 1127232792, 1777100137, 1091405176, 1023962090, 687567900, 1230864146, 1879180420, 220703410, 1223042090, 571771284, 959331960, 264305514, 1082052118, 48585522, 985893394, 1350672992, 1020427087, 720436809, 1990157744, 1907412229, 2121827695, 173744698, 1603718756, 1654257237, 1026292135, 1218706313, 651664255, 1727586408, 1514115931, 878484054, 75045395, 318168216, 1061962880, 1059821098, 635520276, 1434878972, 1810542407, 315905143, 2003071779, 1946054715, 2048707255, 720020714, 352805560, 139120587, 2076295405, 71963522, 1099278040, 1099329634, 1428736764, 918394248, 831416765, 526637716, 1814413243, 1761253040, 665221593, 404397993, 429617840, 1119333062, 1424542182, 501861244, 128574643, 1357211091, 963956505, 1241609956, 320724162, 161983013, 218310130, 1646616452, 1531163590, 1555241100, 672726304, 615346735, 936574152, 1884767544, 845649798, 1566986625, 812969907, 54593478, 1085771146, 2022136033, 1308723991, 411152588, 725256129, 1412273847, 1170671236, 157837606, 632186744, 798258036, 360380490, 1782393583, 774687074, 32771082, 1978610629, 1217099746, 1383567995, 175909787, 1128387530, 2071842460, 497347767, 1962579730, 9180310, 1363932896, 746118029, 62644302, 550249218, 165045160, 899450798, 765109625, 285180803, 1647475906, 926477855, 66073488, 262964421, 1761025397, 1327064959, 280847544, 1549055168, 1977612323, 1659487726, 1254188069, 1737810863, 1387189588, 1617049471, 1220355792, 1987024937, 1423495424, 396250096, 673400881, 1480001213, 1419526705, 1863064110, 1995827794, 1197671043, 1412325179, 1718729448, 771928417, 1938262829, 1798834677, 16449922, 1162575279, 1592054872, 622010355, 1928155969, 500035837, 1582353867, 1920256059, 1472453144, 415086311, 1447073028, 1232315660, 198957443, 179891843, 2015878434, 1397565278, 702949694, 1888319568, 851243965, 2135825886, 1658257513, 1892589821, 260456969, 243578414, 1286478790, 108067005, 338592568, 1604386998, 1197143095, 527286637, 1615521714, 950382591, 190025176, 318508678, 1054064787, 1673185428, 795228991, 1657966385, 936170186, 641112427, 412725876, 661233499, 2089562098, 1288868457, 1902415691, 57275780, 1593523361, 1541441518, 1698876882, 677334031, 19317465, 1170296674, 1621327413, 1870232418, 434840562, 485179280, 1113040629, 1598884884, 1264549628, 46856978, 408941139, 242451782, 1111791129, 1638529389, 1496359849, 1268642385, 371415585, 182740124, 972234823, 255273302, 269350091, 107158177, 1886865361, 290026152, 298829106, 2023413013, 441015888, 562751097, 1902274448, 68507733, 222176611, 619344316, 1628605530, 438851547, 707573334, 1860432092, 1434577431, 211830498, 1526149682, 30406837, 838739781, 385265385, 24717350, 685079039, 1001813320, 1030658800, 2090736890, 1817582128, 304603909, 2025215479, 803074876, 1989100669, 1558270544, 1264127803, 555304169, 614431718, 1200870844, 526315972, 1947713585, 1005096345, 1964981783, 2026033189, 1538274613, 1332610150, 1805081697, 707572118, 801022256, 550841585, 602636658, 1148745730, 962020382, 404501130, 615390903, 1240995772, 2142212113, 1217664098, 2134363614, 1720461625, 644861661, 1220549454, 2115930109, 763132637, 329827063, 981277870, 981459963, 2090404549, 1745717401, 1958887923, 1278239133, 629245497, 1151008517, 1085194198, 795639587, 515559416, 1563760303, 1742960959, 1516746795, 154191835, 1672584171, 631553932, 1118009658, 302557184, 921896864, 929868069, 1166361507, 1325619947, 1258539514, 1307774861, 921502672, 1347196701, 1411959499, 1869986093, 1301283961, 480312857, 1012163985, 1332944971, 1686341622, 698933408, 1749463614, 513407187, 1040431395, 938227851, 2102357631, 58182714, 1921853341, 1214155983, 200569781, 1967551839, 813352708, 180754579, 1412247837, 1808206690, 1001718057, 1411860649, 1988457927, 1372039497, 1616811322, 1032892936, 261302764, 300578312, 348971418, 1222001650, 303909076, 2051394942, 1342450889, 795294831, 1598365423, 1558320889, 815674323, 1056297855, 600482078, 1538054276, 443637405, 1641495057, 1514539215, 740612627, 1309324017, 265568185, 857200470, 583011231, 254145352, 659382789, 1834323935, 157626959, 892917920, 1159163212, 1494778519, 1563209750, 973197405, 495872447, 851810881, 56279957, 1051615704, 1626884344, 491327621, 1960983886, 1440717989, 450500100, 543103058, 1630072886, 1822051874, 781937329, 1191486291, 960279022, 1254884591, 357453020, 545152896, 2120346722, 735581120, 1358101126, 1662159346, 1972381715, 1644484392, 2082951964, 883525227, 1476124780, 59810005, 1727440198, 308241893, 1268496344, 1996387042, 1522338308, 2039682342, 1990824890, 947465153, 1854688555, 225560085, 1417534540, 1954984790, 1910148279, 771060411, 1249119822, 1349367873, 2082166713, 1369311945, 1073252602, 681645126, 1612271630, 1943308645, 1201623634, 509571594, 1205431002, 440931516, 457692509, 1828484751, 939459027, 1459146552, 1282931931, 870171574, 171156896, 273310759, 1310215211, 1692516761, 1528799706, 83132419, 84148261, 1491768234, 1327835692, 1765061158, 33648761, 2005885342, 1898123775, 1014202990, 1978579024, 103703408, 1976374436, 1246661772, 1331970052, 1914109193, 132552996, 1296225803, 442461977, 1506280520, 425726492, 1408342223, 422436643, 1432483043, 436808516, 1206648830, 36093302, 270156165, 1687366405, 1004090089, 161029175, 1585138920, 620473599, 510283428, 1374391464, 685749599, 992938331, 112009563, 1213352092, 1588451745, 1843694991, 1918064500, 1957969165, 1744772383, 1557554955, 222221084, 1372094460, 2012166301, 393757431, 908019988, 244046382, 1420783204, 1540377762, 504876039, 929801725, 108923166, 593461064, 358317714, 2067724684, 1901798504, 556985275, 1048896474, 1783895944, 1774164146, 1288545209, 1798318623, 2128470074, 622092656, 456927299, 2127610394, 1072812833, 2012742093, 2116037579, 2070220479, 179182610, 1366590959, 1801071276, 517763972, 1181582914, 1467653300, 679144957, 1855236067, 42622807, 34011924, 1456813771, 1886279130, 103188583, 2048416854, 1975113736, 2108021130, 1648205373, 742980583, 1595132227, 591792927, 1405189025, 951875969, 1030450855, 596981719, 989473463, 1572623768, 645132314, 680946543, 915473178, 820063412, 405549787, 749915964, 2107729336, 1208064514, 606157454, 37125761, 1711820021, 1948196815, 1648630118, 1667860890, 1028688529, 789423520 };

    // Allocate the host output vector C
    int h_C[SIZE] = {};

    // Allocate the assertion vector C
    int h_C_ass[SIZE] = {};

    for (int i = 0; i < SIZE; ++i)
    {
        h_C_ass[i] = h_A[i] + h_B[i];
    }

    // Add vectors in parallel.
    cudaError_t cudaStatus = addWithCuda(h_C, h_A, h_B, SIZE);
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "addWithCuda failed!");
        return 1;
    }

    // cudaDeviceReset must be called before exiting in order for profiling and
    // tracing tools such as Nsight and Visual Profiler to show complete traces.
    cudaStatus = cudaDeviceReset();
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaDeviceReset failed!");
        return 1;
    }

    // Assert
    bool check = true;
    for (int i = 0; i < SIZE; ++i)
    {
        if (h_C_ass[i] != h_C[i]) {
            check = false;
            printf("Failed on index %d. Asserted: %d. From kernel: %d", i, h_C_ass[i], h_C[i]);
        };
    }
    if (check == true) {
        printf("\nAssertion succeeded!\n");
    }

    return 0;
}

// 0 для константы
int addWrapper(int arraySize) {
    size_t size = arraySize * sizeof(int);
    // Allocate the host input vector A
    int* h_A = (int*)malloc(size);

    // Allocate the host input vector B
    int* h_B = (int*)malloc(size);

    // Allocate the host output vector C
    int* h_C = (int*)malloc(size);

    // Allocate the assertion vector C
    int* h_C_ass = (int*)malloc(size);

    // Verify that allocations succeeded
    if (h_A == NULL || h_B == NULL || h_C == NULL)
    {
        fprintf(stderr, "Failed to allocate host vectors!\n");
        exit(EXIT_FAILURE);
    }

    // Initialize the host input vectors
    for (int i = 0; i < arraySize; ++i)
    {
        h_A[i] = rand();
        h_B[i] = rand();
        h_C_ass[i] = h_A[i] + h_B[i];
    }

    // Add vectors in parallel.
    cudaError_t cudaStatus = addWithCuda(h_C, h_A, h_B, arraySize);
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "addWithCuda failed!");
        return 1;
    }

    // cudaDeviceReset must be called before exiting in order for profiling and
    // tracing tools such as Nsight and Visual Profiler to show complete traces.
    cudaStatus = cudaDeviceReset();
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaDeviceReset failed!");
        return 1;
    }

    // Assert
    bool check = true;
    for (int i = 0; i < arraySize; ++i)
    {
        if (h_C_ass[i] != h_C[i]) {
            check = false;
            printf("Failed on index %d. Asserted: %d. From kernel: %d", i, h_C_ass[i], h_C[i]);
        };
    }
    if (check == true) {
        printf("Assertion succeeded!");
    }

    return 0;
}

// Helper function for using CUDA to add vectors in parallel.
cudaError_t addWithCuda(int* c, const int* a, const int* b, unsigned int size)
{
    int* dev_a = 0;
    int* dev_b = 0;
    int* dev_c = 0;
    cudaError_t cudaStatus;

    // Choose which GPU to run on, change this on a multi-GPU system.
    cudaStatus = cudaSetDevice(0);
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaSetDevice failed!  Do you have a CUDA-capable GPU installed?");
        goto Error;
    }

    // Allocate GPU buffers for three vectors (two input, one output)    .
    cudaStatus = cudaMalloc((void**)&dev_c, size * sizeof(int));
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaMalloc failed!");
        goto Error;
    }

    cudaStatus = cudaMalloc((void**)&dev_a, size * sizeof(int));
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaMalloc failed!");
        goto Error;
    }

    cudaStatus = cudaMalloc((void**)&dev_b, size * sizeof(int));
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaMalloc failed!");
        goto Error;
    }

    // Высчитываем с момента копирования
    unsigned int start_time = clock();

    // Copy input vectors from host memory to GPU buffers.
    cudaStatus = cudaMemcpy(dev_a, a, size * sizeof(int), cudaMemcpyHostToDevice);
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaMemcpy failed!");
        goto Error;
    }

    cudaStatus = cudaMemcpy(dev_b, b, size * sizeof(int), cudaMemcpyHostToDevice);
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaMemcpy failed!");
        goto Error;
    }

    int threadsPerBlock = std::min((unsigned int)1024, size);
    int blocksPerGrid = std::max((unsigned int)1, (size + threadsPerBlock - 1) / threadsPerBlock);
    printf("CUDA kernel launch with %d blocks of %d threads\n", blocksPerGrid, threadsPerBlock);
    addKernel << <blocksPerGrid, threadsPerBlock >> > (dev_c, dev_a, dev_b, size);

    // Check for any errors launching the kernel
    cudaStatus = cudaGetLastError();
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "addKernel launch failed: %s\n", cudaGetErrorString(cudaStatus));
        goto Error;
    }

    // cudaDeviceSynchronize waits for the kernel to finish, and returns
    // any errors encountered during the launch.
    cudaStatus = cudaDeviceSynchronize();
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaDeviceSynchronize returned error code %d after launching addKernel!\n", cudaStatus);
        goto Error;
    }

    // Copy output vector from GPU buffer to host memory.
    cudaStatus = cudaMemcpy(c, dev_c, size * sizeof(int), cudaMemcpyDeviceToHost);
    if (cudaStatus != cudaSuccess) {
        fprintf(stderr, "cudaMemcpy failed!");
        goto Error;
    }

    unsigned int end_time = clock();
    unsigned int search_time = end_time - start_time;
    printf("Время выполнения: %d мс.", search_time);

Error:
    cudaFree(dev_c);
    cudaFree(dev_a);
    cudaFree(dev_b);

    return cudaStatus;
}